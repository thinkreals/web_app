# coding: utf-8

class ExampleController < InheritedResources::Base
  # belongs_to :user, :singleton => true            
  
  # load_and_authorize_resource
   
  def index  
    index! do |format|
      format.html
      format.json { render_collection_json collection, :include => [] }
    end
  end
  
  def show
    show! do |format|
      format.html
      format.json { render_resource_json resource, :include => [] }
    end
  end
  
  def update   
    update! do |success, failure|    
      success.html
      success.json { redirect_to resource_url(format: 'json', v: params[:v]) }
      
      failure.html
      failure.json { render_fail_json resource.errors.messages }
    end
  end
  
  def create 
    create! do |success, failure|
      success.html 
      success.json { redirect_to resource_url(format: 'json', v: params[:v]) }

      failure.html
      failure.json { render_fail_json(resource.errors.messages) }
    end
    
  end       
  
  def destroy  
    destroy! do |success, failure|                               
      success.html 
      success.json { render_success_json('Successfully destroyed.') }

      failure.html
      failure.json { render_fail_json(resource.errors.messages) }
    end
  end

  protected
  def collection
    @examples ||= end_of_association_chain.page(params[:page]).per(params[:per_page])
  end

end
